<!doctype html>
<meta charset="utf-8" />
<title>Alma Chat</title>
<style>
  body{font-family:system-ui,arial;padding:24px;max-width:720px;margin:auto}
  h1{margin:0 0 12px}
  #chat{border:1px solid #ddd;background:#fafafa;height:320px;overflow:auto;padding:12px;margin:12px 0}
  .msg{margin:6px 0}.user{font-weight:700}.alma{color:#2563eb}
  .row{display:flex;gap:8px} input{flex:1;padding:10px} button{padding:10px 14px}
</style>

<h1>Alma Chat</h1>
<div id="chat"></div>
<div class="row">
  <input id="q" placeholder="Escreve a tua mensagemâ€¦" />
  <button id="ask">Enviar</button>
</div>

<script>
const API_BASE = "https://alma-server-alma-1.up.railway.app"; // <- servidor de TEXTO
function add(sender, text){
  const div=document.createElement('div');
  div.className='msg '+sender;
  div.innerHTML = `<span class="${sender}">${sender==='user'?'Tu':'Alma'}:</span> ${text}`;
  chat.appendChild(div); chat.scrollTop = chat.scrollHeight;
}
const chat = document.getElementById('chat');
document.getElementById('ask').onclick = async () => {
  const text = document.getElementById('q').value.trim(); if(!text) return;
  add('user', text); document.getElementById('q').value='';
  try{
    const r = await fetch(API_BASE + "/ask", {
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify({ question: text })
    });
    if(!r.ok){ add('alma', `Erro HTTP ${r.status}`); return; }
    const j = await r.json();
    add('alma', j.answer ?? JSON.stringify(j));
  }catch(e){ add('alma', "Erro: "+e.message); }
};
</script>
